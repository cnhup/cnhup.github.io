<!DOCTYPE HTML>
<html lang="en-us">
<head>
  <meta charset="UTF-8">
  <title>Vba Functions - Excel Tools | Excel Tool Set</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=3, minimum-scale=1">
  
  <meta name="description" content="Vba Functions">
  <meta name="author" content="exceltoolset">
  <meta itemprop="name" content="Vba Functions - Excel Tools | Excel Tool Set">
  <meta itemprop="description" content="Vba Functions">
  <meta itemprop="image" content="http://www.exceltoolset.com/img/author.jpg">
  
  
  <meta name="twitter:description" content="">
  <link rel="alternate" href="http://www.exceltoolset.com/feed.xml" title="Excel Tools | Excel Tool Set" type="application/rss+xml"/>
  <link rel="shortcut icon" href="http://www.exceltoolset.com/img/favicon.ico"/>
  <link rel="apple-touch-icon" href="http://www.exceltoolset.com/apple-touch-icon.png" />
  <link rel="apple-touch-icon-precomposed" href="http://www.exceltoolset.com/apple-touch-icon.png" />

  
  <link rel="stylesheet" href="http://www.exceltoolset.com/prism/prism.css">
  <script src="http://www.exceltoolset.com/prism/prism.js"></script>

  <link rel="stylesheet" href="http://www.exceltoolset.com/font/hack/css/hack.min.css">
  <link rel="stylesheet" href="http://www.exceltoolset.com/css/style.css">
</head>

<body>
  <header>
    <div>
  
  <div id="textlogo">
    <h1 class="site-name"><a href="http://www.exceltoolset.com/" title="Excel Tools | Excel Tool Set">Excel Tools | Excel Tool Set</a></h1>
    <h2 class="blog-motto"></h2>
  </div>
  <div class="navbar"><a class="navbutton navmobile" href="#" title="menu"></a></div>
  <nav class="animated">
    <ul>
      
      <li>
        
      </li>
    </ul>
  </nav>
</div>

  </header>
  <div id="container">
    <div id="main">
      
      <h2 id="2014-05">2014-05</h2>
      
      <section class="post" itemscope itemprop="blogPost">
    <a href="http://www.exceltoolset.com/sending-email-with-vba/" title="Sending EMail With VBA" itemprop="url">
    <h1 itemprop="name">Sending EMail With VBA</h1>
    <p itemprop="description"><p>It is not difficult to add the ability to send email from your application. If all you want to do is send the workbook, with just a subject but no content, you can use ThisWorkbook.SendMail. However, if you want to include text in the body of the message or include additional files as attachments, you need some VBA code. The page describes a function called <strong>SendEmail</strong> that wraps up the details in a nice, VBA-friendly function.</p>
</p>
    <time datetime="2014-05-31 01:38:01 &#43;0000 &#43;0000" itemprop="datePublished">
      
      
      <h2 id="2011-05">2011-05</h2>
      
      <section class="post" itemscope itemprop="blogPost">
    <a href="http://www.exceltoolset.com/get-a-specific-element-in-the-text-string-with-vba/" title="Get A Specific Element In The Text String With VBA" itemprop="url">
    <h1 itemprop="name">Get A Specific Element In The Text String With VBA</h1>
    <p itemprop="description"><p>Often, data is stored in a single worksheet cell consisting of several values, separated by some delimiter. For example, a cell may contain Abby,Barb,Carrie,Dawn, a list of names separated by commas. How should we get a specific element in the text string?</p>
</p>
    <time datetime="2011-05-11 23:09:11 &#43;0000 &#43;0000" itemprop="datePublished">
      
      
      <h2 id="2010-11">2010-11</h2>
      
      <section class="post" itemscope itemprop="blogPost">
    <a href="http://www.exceltoolset.com/how-to-get-the-data-type-of-a-cell-in-excel/" title="How To Get The Data Type Of A Cell In Excel" itemprop="url">
    <h1 itemprop="name">How To Get The Data Type Of A Cell In Excel</h1>
    <p itemprop="description"><p>In some situations you may need to determine the type of data in a cell. Excel provides a number of built-in functions that can help. These include ISTEXT, ISLOGICAL, and ISERROR. In addition, VBA includes functions such as IsEmpty, IsDate, and IsNumeric.</p>
</p>
    <time datetime="2010-11-07 02:47:25 &#43;0000 &#43;0000" itemprop="datePublished">
      
      <section class="post" itemscope itemprop="blogPost">
    <a href="http://www.exceltoolset.com/how-to-determine-the-type-of-a-particular-drive-using-vba/" title="How to Determine The Type Of A Particular Drive Using VBA" itemprop="url">
    <h1 itemprop="name">How to Determine The Type Of A Particular Drive Using VBA</h1>
    <p itemprop="description"><p>This article contains a VBA function that uses the Windows GetDriveType API function to determine the type of a particular drive.</p>

<pre><code class="language-basic">Private Declare Function GetDriveType Lib &quot;kernel32&quot; _
  Alias &quot;GetDriveTypeA&quot; (ByVal nDrive As String) As Long

Function DriveType(DriveLetter As String) As String
'  Returns a string that describes the type of drive of DriveLetter
   DriveLetter = Left(DriveLetter, 1) &amp; &quot;:\&quot;
   Select Case GetDriveType(DriveLetter)
      Case 0: DriveType = &quot;Unknown&quot;
      Case 1: DriveType = &quot;Non-existent&quot;
      Case 2: DriveType = &quot;Removable drive&quot;
      Case 3: DriveType = &quot;Fixed drive&quot;
      Case 4: DriveType = &quot;Network drive&quot;
      Case 5: DriveType = &quot;CD-ROM drive&quot;
      Case 6: DriveType = &quot;RAM disk&quot;
      Case Else: DriveType = &quot;Unknown drive type&quot;
  End Select
End Function
</code></pre>
</p>
    <time datetime="2010-11-05 00:32:17 &#43;0000 &#43;0000" itemprop="datePublished">
      
      <section class="post" itemscope itemprop="blogPost">
    <a href="http://www.exceltoolset.com/how-to-get-the-computer-name-or-logged-in-user-name-using-vba/" title="How To Get The Computer Name Or Logged-in User Name Using VBA" itemprop="url">
    <h1 itemprop="name">How To Get The Computer Name Or Logged-in User Name Using VBA</h1>
    <p itemprop="description"><p>This article uses two Windows API functions to return the name of the computer, and the name of the user who is currently logged in. These functions can be used in a worksheet formula, or called from a VBA procedure.</p>
</p>
    <time datetime="2010-11-04 04:04:40 &#43;0000 &#43;0000" itemprop="datePublished">
      
      <section class="post" itemscope itemprop="blogPost">
    <a href="http://www.exceltoolset.com/making-a-single-worksheet-function-act-like-multiple-functions/" title="Making A Single Worksheet Function Act Like Multiple Functions" itemprop="url">
    <h1 itemprop="name">Making A Single Worksheet Function Act Like Multiple Functions</h1>
    <p itemprop="description"><p>This article describes a technique that may be helpful in some situations &#8211; making a single worksheet function act like multiple functions. For example, the VBA listing below is for a custom function called StatFunction. It takes two arguments: the range (rng), and the operation (op). Depending on the value of op, the function will return any of the following: AVERAGE, COUNT, MAX, MEDIAN, MIN, MODE, STDEV, SUM, or VAR.</p>
</p>
    <time datetime="2010-11-02 23:07:25 &#43;0000 &#43;0000" itemprop="datePublished">
      
      
      <h2 id="2010-10">2010-10</h2>
      
      <section class="post" itemscope itemprop="blogPost">
    <a href="http://www.exceltoolset.com/a-simple-vba-function-for-testing-a-filename-is-valid/" title="A Simple VBA Function For Testing A FileName Is Valid" itemprop="url">
    <h1 itemprop="name">A Simple VBA Function For Testing A FileName Is Valid</h1>
    <p itemprop="description"><p>Sometimes we save a file, but it returns &#8220;Illegal Windows filename characters&#8221; error.</p>

<p>Maybe we need a robust and simple way to remove illegal path and file characters from a simple string.</p>

<p>How check if given string is legal (allowed) file name under Windows?</p>
</p>
    <time datetime="2010-10-30 11:03:59 &#43;0000 &#43;0000" itemprop="datePublished">
      
      <section class="post" itemscope itemprop="blogPost">
    <a href="http://www.exceltoolset.com/how-to-create-dsn-for-odbc-using-vba/" title="How To Create DSN For ODBC Using VBA" itemprop="url">
    <h1 itemprop="name">How To Create DSN For ODBC Using VBA</h1>
    <p itemprop="description"><p>This article describes a VBA function that will Create DSN For ODBC. The VBA function use API function SQLConfigDataSource to do this. Then you can create DSN for ODBC in your code.</p>

<p>The VBA code is bellow.</p>
</p>
    <time datetime="2010-10-29 23:24:34 &#43;0000 &#43;0000" itemprop="datePublished">
      
      <section class="post" itemscope itemprop="blogPost">
    <a href="http://www.exceltoolset.com/track-who-opens-a-workbook-and-at-what-time/" title="Track Who Opens A Workbook And At What Time" itemprop="url">
    <h1 itemprop="name">Track Who Opens A Workbook And At What Time</h1>
    <p itemprop="description"><p>This article describes how to create a usage log that keeps track who opens a workbook, and at what time.</p>

<p>If a workbook&#8217;s ThisWorkbook code module contains a procedure named Workbook_Open, that procedure is executed whenever the workbook is opened. Add the following procedure to the ThisWorkbook code module.</p>
</p>
    <time datetime="2010-10-28 10:59:43 &#43;0000 &#43;0000" itemprop="datePublished">
      
      <section class="post" itemscope itemprop="blogPost">
    <a href="http://www.exceltoolset.com/select-all-unlocked-cells-using-vba-in-excel/" title="Select All Unlocked Cells Using VBA in Excel" itemprop="url">
    <h1 itemprop="name">Select All Unlocked Cells Using VBA in Excel</h1>
    <p itemprop="description"><p>As you probably know, when a worksheet is protected, only the unlocked cells can be changed. You may want to apply different formatting to the unlocked cells, or simply ensure that the correct cells are indeed unlocked.</p>

<p>Oddly, there is no direct way to quickly identify which cells are locked or unlocked. When the sheet is protected, you can use the Tab key to move among the unlocked cells, but it you would like to select them all you&#8217;ll need a macro.</p>
</p>
    <time datetime="2010-10-27 03:47:50 &#43;0000 &#43;0000" itemprop="datePublished">
      
      <section class="post" itemscope itemprop="blogPost">
    <a href="http://www.exceltoolset.com/how-to-get-temp-file-name-using-vba/" title="How to Get Temp File Name Using VBA" itemprop="url">
    <h1 itemprop="name">How to Get Temp File Name Using VBA</h1>
    <p itemprop="description"><p>This page describes a VBA function that will return a Unique Temporary File Name. The VBA function use API to do this. You can also specify prefix or file extensions to include in the Temporary File Name.</p>
</p>
    <time datetime="2010-10-27 02:03:37 &#43;0000 &#43;0000" itemprop="datePublished">
      
      <section class="post" itemscope itemprop="blogPost">
    <a href="http://www.exceltoolset.com/vba-function-to-count-word-frequencies/" title="VBA Function To Count Word Frequencies" itemprop="url">
    <h1 itemprop="name">VBA Function To Count Word Frequencies</h1>
    <p itemprop="description"><p>This article describes a VBA function that analyzes a list of text, and counts the frequency of each word. The function works with any text. It assumes that the data begins in cell A1 of the active sheet, and the first blank cell in the column signals the end of the text.</p>
</p>
    <time datetime="2010-10-26 06:55:23 &#43;0000 &#43;0000" itemprop="datePublished">
      
      <section class="post" itemscope itemprop="blogPost">
    <a href="http://www.exceltoolset.com/two-functions-for-testing-a-specified-word-is-contained-in-a-text-string/" title="Two Functions For Testing A Specified Word Is Contained In A Text String" itemprop="url">
    <h1 itemprop="name">Two Functions For Testing A Specified Word Is Contained In A Text String</h1>
    <p itemprop="description"><p>Here&#8217;s a VBA function that might be useful in some situations.</p>

<p>The IsWordInString functions returns True if a specified word is contained in a text string.</p>

<p>You might think that this function is just a variation on Excel&#8217;s FIND function or VBA&#8217;s Instr function. There&#8217;s a subtle difference. The <strong>IsWordInString</strong> function looks for a complete word &#8212; not text that might be part of a different word.</p>
</p>
    <time datetime="2010-10-25 01:33:43 &#43;0000 &#43;0000" itemprop="datePublished">
      
      <section class="post" itemscope itemprop="blogPost">
    <a href="http://www.exceltoolset.com/using-vba-to-send-a-text-file-to-a-server-via-ftp-in-excel/" title="Using VBA to Send a text file to a server via FTP in Excel" itemprop="url">
    <h1 itemprop="name">Using VBA to Send a text file to a server via FTP in Excel</h1>
    <p itemprop="description"><p>I have an Excel worksheet where the user enters certain data, which I want to store in a text file and upload to a server using FTP. Does anyone know of a solution for this problem?</p>

<p>The following VBA code is one solution for this problem.</p>
</p>
    <time datetime="2010-10-24 13:45:53 &#43;0000 &#43;0000" itemprop="datePublished">
      
      <section class="post" itemscope itemprop="blogPost">
    <a href="http://www.exceltoolset.com/setting-a-reference-to-the-vba-extensibility-library-by-code/" title="Setting a reference to the VBA Extensibility library by code" itemprop="url">
    <h1 itemprop="name">Setting a reference to the VBA Extensibility library by code</h1>
    <p itemprop="description"><p>When your coding the VBE you have to set a reference to the VBA Extensibility library. You can add the reference programmatically with code like:</p>
</p>
    <time datetime="2010-10-24 00:57:04 &#43;0000 &#43;0000" itemprop="datePublished">
      
      <section class="post" itemscope itemprop="blogPost">
    <a href="http://www.exceltoolset.com/vba-get-objects-parent-workbook/" title="VBA Get Object&#39;s Parent Workbook" itemprop="url">
    <h1 itemprop="name">VBA Get Object&#39;s Parent Workbook</h1>
    <p itemprop="description">How can I get the parent Workbook of an Object? Here give the source code to solve the problem.The VBA function name is GetObjectParentWorkbook. Function GetObjectParentWorkbook(aObject As Object) As Workbook Dim o As Object On Error GoTo ErrorHandle If aObject Is Nothing Then GoTo ErrorExit Set o = aObject.Parent If TypeOf aObject Is Workbook Then Set GetObjectParentWorkbook = aObject GoTo ErrorExit End If Do Until (TypeOf o Is Workbook) Or</p>
    <time datetime="2010-10-22 15:03:47 &#43;0000 &#43;0000" itemprop="datePublished">
      
      <section class="post" itemscope itemprop="blogPost">
    <a href="http://www.exceltoolset.com/vba-get-objects-parent-sheet/" title="VBA Get Object&#39;s Parent Sheet" itemprop="url">
    <h1 itemprop="name">VBA Get Object&#39;s Parent Sheet</h1>
    <p itemprop="description">Where is the parent sheet of an object in VBA? The useful VBA function GetObjectParentSheet will help you to do this. Function GetObjectParentSheet(aObject As Object) As Object Dim op As Object On Error Resume Next If aObject Is Nothing Then GoTo ErrorExit Set op = aObject.Parent If op Is Nothing Then GoTo ErrorExit If TypeOf op Is Workbook Then Set GetObjectParentSheet = aObject GoTo ErrorExit End If Do Until (TypeOf</p>
    <time datetime="2010-10-22 14:57:03 &#43;0000 &#43;0000" itemprop="datePublished">
      
      <section class="post" itemscope itemprop="blogPost">
    <a href="http://www.exceltoolset.com/get-range-from-address-string/" title="Get Range from address string" itemprop="url">
    <h1 itemprop="name">Get Range from address string</h1>
    <p itemprop="description"><p>Sometimes we want to get Range from address string in VBA, here give a VBA function RangeFromAddress, the code is following.</p>

<p>Note: The RangeFromAddress&#8217; reference:</p>

<p><a href="http://www.exceltoolset.com/vba-get-objects-parent-sheet/">VBA Get Object’s Parent Sheet</a></p>

<p><a href="http://www.exceltoolset.com/vba-get-objects-parent-workbook/">VBA Get Object’s Parent Workbook</a></p>
</p>
    <time datetime="2010-10-22 14:30:29 &#43;0000 &#43;0000" itemprop="datePublished">
      
      
    </div>
    <div class="openaside"><a class="navbutton" href="#" title=""></a></div>
<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title=""></a></div>
<aside class="clearfix">
  

<div class="categorieslist">
  <p class="asidetitle"></p>
  <ul>
    
    <li><a href="http://www.exceltoolset.com/categories/excel-articles" title="excel-articles">excel-articles</a></li>
    
    <li><a href="http://www.exceltoolset.com/categories/excel-tools" title="excel-tools">excel-tools</a></li>
    
    <li><a href="http://www.exceltoolset.com/categories/vba-functions" title="vba-functions">vba-functions</a></li>
    
  </ul>
</div>



  

<div class="tagslist">
	<p class="asidetitle"></p>
		<ul class="clearfix">
      
		</ul>
		<script async src="//pagead2.googlesyndication.com/pagead/js/adsbygoogle.js"></script>

<ins class="adsbygoogle"
     style="display:inline-block;width:250px;height:250px"
     data-ad-client="ca-pub-8959967476058178"
     data-ad-slot="0048712512"></ins>
<script>
(adsbygoogle = window.adsbygoogle || []).push({});
</script>
</div>



  
  <div class="archiveslist">
    <p class="asidetitle"></p>
    <ul class="archive-list">
      
  



  
<div class="rsspart">
  <a rel="nofollow" href="http://www.exceltoolset.com/feed.xml" type="application/rss+xml" target="_blank"></a>
</div>


</aside>
</div>

  </div>
  <footer><div id="footer" >
  
  
  <div class="social-font clearfix">
    
    
    
    
    
  </div>
  <p class="copyright"> © 2017
    
    <a href="http://www.exceltoolset.com/" target="_blank" title="exceltoolset">exceltoolset</a>
    
  </p>
</div>
</footer>
  <script src="http://www.exceltoolset.com/js/jquery-2.1.0.min.js"></script>
<script type="text/javascript">
done = false;
$(document).ready(function(){
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  $(window).resize(function(){
    getSize();
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else
    {
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
    }
  });
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  $('form.search').on('submit', function (event) {
    if (false === done) {
      event.preventDefault();
      var orgVal = $(this).find('#search').val();
      $(this).find('#search').val('site:http:\/\/www.exceltoolset.com\/ ' + orgVal);
      done = true;
      $(this).submit();
    }
  });
});
</script>






</body>
</html>
