<!DOCTYPE HTML>
<html lang="en-us">
<head>
  <meta charset="UTF-8">
  <title>VBA Function To Count Word Frequencies - Excel Tools | Excel Tool Set</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=3, minimum-scale=1">
  
  <meta name="description" content="This article describes a VBA function that analyzes a list of text, and counts the frequency of each word. The function works with any text. It assumes that the data begins in cell A1 of the active sheet, and the first blank cell in the column signals the end of the text.
">
  <meta name="author" content="exceltoolset">
  <meta itemprop="name" content="VBA Function To Count Word Frequencies - Excel Tools | Excel Tool Set">
  <meta itemprop="description" content="This article describes a VBA function that analyzes a list of text, and counts the frequency of each word. The function works with any text. It assumes that the data begins in cell A1 of the active sheet, and the first blank cell in the column signals the end of the text.
">
  <meta itemprop="image" content="http://www.exceltoolset.com/img/author.jpg">
  
  
  <meta name="twitter:description" content="">
  
  <link rel="shortcut icon" href="http://www.exceltoolset.com/img/favicon.ico"/>
  <link rel="apple-touch-icon" href="http://www.exceltoolset.com/apple-touch-icon.png" />
  <link rel="apple-touch-icon-precomposed" href="http://www.exceltoolset.com/apple-touch-icon.png" />

  
  <link rel="stylesheet" href="http://www.exceltoolset.com/prism/prism.css">
  <script src="http://www.exceltoolset.com/prism/prism.js"></script>

  <link rel="stylesheet" href="http://www.exceltoolset.com/font/hack/css/hack.min.css">
  <link rel="stylesheet" href="http://www.exceltoolset.com/css/style.css">
</head>

<body>
  <header>
    <div>
  
  <div id="textlogo">
    <h1 class="site-name"><a href="http://www.exceltoolset.com/" title="Excel Tools | Excel Tool Set">Excel Tools | Excel Tool Set</a></h1>
    <h2 class="blog-motto"></h2>
  </div>
  <div class="navbar"><a class="navbutton navmobile" href="#" title="menu"></a></div>
  <nav class="animated">
    <ul>
      
      <li>
        
      </li>
    </ul>
  </nav>
</div>

  </header>
  <div id="container">
    <div id="main" class="post" itemscope itemprop="blogPost">
	<article itemprop="articleBody">
    <header class="article-info clearfix">
  <h1 itemprop="name">
      <a href="http://www.exceltoolset.com/vba-function-to-count-word-frequencies/" title="VBA Function To Count Word Frequencies" itemprop="url">VBA Function To Count Word Frequencies</a>
  </h1>
  <p class="article-author">By
    
      <a href="" title="exceltoolset">exceltoolset</a>
    
  </p>
  <p class="article-time">
    <time datetime="2010-10-26 06:55:23 &#43;0000 &#43;0000" itemprop="datePublished">
	<div class="article-content">
    
    <p>This article describes a VBA function that analyzes a list of text, and counts the frequency of each word. The function works with any text. It assumes that the data begins in cell A1 of the active sheet, and the first blank cell in the column signals the end of the text.</p>

<p>The general approach is:</p>

<ol>
<li>Add a new worksheet for the results</li>
<li>Remove all punctuation characters from the input text</li>
<li>Convert each word to upper case, and remove excess spaces</li>
<li>Loop through the input text and put each word in the results sheet</li>
<li>Create a pivot table that uses the word list and displays a frequency count for each word.</li>
</ol>

<p>Here&#8217;s the function:</p>

<pre><code class="language-basic">Sub CountWordFrequencies()
    Dim InputSheet As Worksheet
    Dim WordListSheet As Worksheet
    Dim PuncChars As Variant, x As Variant
    Dim i As Long, r As Long
    Dim txt As String
    Dim wordCnt As Long
    Dim AllWords As Range
    Dim PC As PivotCache
    Dim PT As PivotTable
    
    Application.ScreenUpdating = False
    Set InputSheet = ActiveSheet
    Set WordListSheet = Worksheets.Add(after:=Worksheets(Sheets.Count))
    WordListSheet.Range(&quot;A1&quot;) = &quot;All Words&quot;
    WordListSheet.Range(&quot;A1&quot;).Font.Bold = True
    InputSheet.Activate
    wordCnt = 2
    PuncChars = Array(&quot;.&quot;, &quot;,&quot;, &quot;;&quot;, &quot;:&quot;, &quot;'&quot;, &quot;!&quot;, &quot;#&quot;, _
        &quot;$&quot;, &quot;%&quot;, &quot;&amp;&quot;, &quot;(&quot;, &quot;)&quot;, &quot; - &quot;, &quot;_&quot;, &quot;--&quot;, &quot;+&quot;, _
        &quot;=&quot;, &quot;~&quot;, &quot;/&quot;, &quot;\&quot;, &quot;{&quot;, &quot;}&quot;, &quot;[&quot;, &quot;]&quot;, &quot;&quot;&quot;&quot;, &quot;?&quot;, &quot;*&quot;)
    r = 1

'   Loop until blank cell is encountered
    Do While Cells(r, 1) &amp;lt;&gt; &quot;&quot;
'       covert to UPPERCASE
        txt = UCase(Cells(r, 1))
'       Remove punctuation
        For i = 0 To UBound(PuncChars)
            txt = Replace(txt, PuncChars(i), &quot;&quot;)
        Next i
'       Remove excess spaces
        txt = WorksheetFunction.Trim(txt)
'       Extract the words
        x = Split(txt)
        For i = 0 To UBound(x)
            WordListSheet.Cells(wordCnt, 1) = x(i)
            wordCnt = wordCnt + 1
        Next i
    r = r + 1
    Loop
    
'   Create pivot table
    WordListSheet.Activate
    Set AllWords = Range(&quot;A1&quot;).CurrentRegion
    Set PC = ActiveWorkbook.PivotCaches.Add _
        (SourceType:=xlDatabase, _
        SourceData:=AllWords)
    Set PT = PC.CreatePivotTable _
        (TableDestination:=Range(&quot;C1&quot;), _
        TableName:=&quot;PivotTable1&quot;)
    With PT
        .AddDataField .PivotFields(&quot;All Words&quot;)
        .PivotFields(&quot;All Words&quot;).Orientation = xlRowField
    End With
End Sub
</code></pre>

<p>From: <a href="http://spreadsheetpage.com">http://spreadsheetpage.com</a></p>

	</div>
  <footer class="article-footer clearfix">
  



<div class="article-categories">
  <span></span>
  
  <a class="article-category-link" href="http://www.exceltoolset.com/categories/vba-functions">VBA Functions</a>
  
</div>



  <div class="article-share" id="share">
    <div data-url="http://www.exceltoolset.com/vba-function-to-count-word-frequencies/" data-title="VBA Function To Count Word Frequencies" data-tsina="" class="share clearfix">
    </div>
  </div>
</footer>

	</article>
  



</div>

    <div class="openaside"><a class="navbutton" href="#" title=""></a></div>
<div id="asidepart">
<div class="closeaside"><a class="closebutton" href="#" title=""></a></div>
<aside class="clearfix">
  

<div class="categorieslist">
  <p class="asidetitle"></p>
  <ul>
    
    <li><a href="http://www.exceltoolset.com/categories/excel-articles" title="excel-articles">excel-articles</a></li>
    
    <li><a href="http://www.exceltoolset.com/categories/excel-tools" title="excel-tools">excel-tools</a></li>
    
    <li><a href="http://www.exceltoolset.com/categories/vba-functions" title="vba-functions">vba-functions</a></li>
    
  </ul>
</div>



  



  
  <div class="archiveslist">
    <p class="asidetitle"></p>
    <ul class="archive-list">
      
  



  

</aside>
</div>

  </div>
  <footer><div id="footer" >
  
  
  <div class="social-font clearfix">
    
    
    
    
    
  </div>
  <p class="copyright"> Â© 2016
    
    <a href="http://www.exceltoolset.com/" target="_blank" title="exceltoolset">exceltoolset</a>
    
  </p>
</div>
</footer>
  <script src="http://www.exceltoolset.com/js/jquery-2.1.0.min.js"></script>
<script type="text/javascript">
done = false;
$(document).ready(function(){
  $('.navbar').click(function(){
    $('header nav').toggleClass('shownav');
  });
  var myWidth = 0;
  function getSize(){
    if( typeof( window.innerWidth ) == 'number' ) {
      myWidth = window.innerWidth;
    } else if( document.documentElement && document.documentElement.clientWidth) {
      myWidth = document.documentElement.clientWidth;
    };
  };
  var m = $('#main'),
      a = $('#asidepart'),
      c = $('.closeaside'),
      o = $('.openaside');
  $(window).resize(function(){
    getSize();
    if (myWidth >= 1024) {
      $('header nav').removeClass('shownav');
    }else
    {
      m.removeClass('moveMain');
      a.css('display', 'block').removeClass('fadeOut');
      o.css('display', 'none');
    }
  });
  c.click(function(){
    a.addClass('fadeOut').css('display', 'none');
    o.css('display', 'block').addClass('fadeIn');
    m.addClass('moveMain');
  });
  o.click(function(){
    o.css('display', 'none').removeClass('beforeFadeIn');
    a.css('display', 'block').removeClass('fadeOut').addClass('fadeIn');
    m.removeClass('moveMain');
  });
  $(window).scroll(function(){
    o.css("top",Math.max(80,260-$(this).scrollTop()));
  });
  $('form.search').on('submit', function (event) {
    if (false === done) {
      event.preventDefault();
      var orgVal = $(this).find('#search').val();
      $(this).find('#search').val('site:http:\/\/www.exceltoolset.com\/ ' + orgVal);
      done = true;
      $(this).submit();
    }
  });
});
</script>






</body>
</html>
